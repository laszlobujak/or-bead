import java.io.IOException;
import java.net.ServerSocket;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class MusicBox {
    static Map<String, Song> songs = new HashMap<>();
    static List<CurrentPlay> listOfCurrentPlays = new ArrayList<>();

    public static void main(String[] args) {

        ExecutorService executorService = Executors.newFixedThreadPool(200);

        songs.put("boci", new Song("C 4 E 4 C 4 E 4 G 8 G 8 REP 6;1 C/1 4 B 4 A 4 G 4 F 8 A 8 G 4 F 4 E 4 D 4 C 8 C 8"));
        songs.put("valami", new Song("D 1 D 3 D/1 1 D/1 3 C/1 1 C/1 3 C/1 2 C/1 2 D/1 1 D/1 3 C/1 1 Bb 3 A 4 A 2 R 2 REP 15;1 Bb 4 A 2 G 2 F 1 F 3 E 2 D 2 G 2 G 2 C/1 2 Bb 2 A 4 D/1 2 R 2 C/1 1 Bb 3 A 2 G 2 G 1 A 3 G 2 F 2 A 1 G 3 F# 2 Eb 2 D 4 D 2 R 2"));

        songs.put("jurinka", new Song("E 4 R 4 R 4 R 4 D 4 C# 4 C 8 E/-1 2 E/-1 2 E 2 E/-1 2 E/-1 2 Eb 2 E/-1 2 E/-1 2 D 4 C# 4 C 8 E/-1 2 E/-1 2 B/-1 2 E/-1 2 E/-1 2 Bb/-1 2 E/-1 2 E/-1 2 A/-1 2 E/-1 2 Ab/-1 2 E/-1 2 G/-1 2 E/-1 2 F#/-1 2 F/-1 2 REP 27;3 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 2 B/-1 2 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 REP 32;1 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 2 B/-1 2 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 4 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 2 B/-1 2 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 REP 63;1 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 E 2 Bb 2 REP 3;3 E/-1 2 E 2 Bb 4 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 A#/-1 2 A/-1 2 G/-1 2 A/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 G/-1 2 A/-1 2 REP 30;5 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 A/-1 2 B/-1 2 F#/-1 2 C 2 B/-1 2 A/-1 2 B/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 A/-1 2 B/-1 2 F#/-1 2 A/-1 2 B/-1 2 REP 30;1 B/-1 2 REP 1;7 E 2 E/-1 2 E/-1 2 E/-1 2 D 4 E 4 E 2 F# 2 B 2 F# 2 F# 1 G 7 C 2 C 2 C 2 C 2 C 4 B/-1 4 B/-1 2 B/-1 2 B/-1 2 B/-1 2 Eb 4 B/-1 4 REP 24;2 E 2 E/-1 2 E/-1 2 E/-1 2 D 4 E 4 E 2 F# 2 B 2 F# 2 F# 1 G 7 C 2 C 2 C 2 C 2 C 4 B/-1 4 G 2 F# 2 E 4 C 2 B/-1 2 A/-1 4 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 14 E/-1 2 E/-1 2 E/-1 2 F#/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 14 C 14 A/-1 2 A/-1 2 A/-1 2 B/-1 2 A/-1 2 A/-1 2 A/-1 2 A/-1 14 D 14 E/-1 2 E/-1 2 E/-1 2 C 2 E/-1 2 E/-1 2 E/-1 2 B/-1 14 E 14 E/-1 2 E/-1 2 E/-1 2 D 2 E/-1 2 E/-1 2 E/-1 2 C 14 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 14 E/-1 2 E/-1 2 E/-1 2 D 2 E/-1 2 E/-1 2 E/-1 2 C 14 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 2 B/-1 2 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 4 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 2 B/-1 2 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 A#/-1 2 A/-1 2 G/-1 2 A/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 G/-1 2 A/-1 2 REP 30;5 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 A/-1 2 B/-1 2 F#/-1 2 C 2 B/-1 2 A/-1 2 B/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 A/-1 2 B/-1 2 F#/-1 2 A/-1 2 B/-1 2 REP 30;1 B/-1 2 REP 1;7 E 2 E/-1 2 E/-1 2 E/-1 2 D 4 E 4 E 2 F# 2 B 2 F# 2 F# 1 G 7 C 2 C 2 C 2 C 2 C 4 B/-1 4 B/-1 2 B/-1 2 B/-1 2 B/-1 2 Eb 4 B/-1 4 REP 24;2 E 2 E/-1 2 E/-1 2 E/-1 2 D 4 E 4 E 2 F# 2 B 2 F# 2 F# 1 G 7 C 2 C 2 C 2 C 2 C 4 B/-1 4 G 2 F# 2 E 4 C 2 B/-1 2 A/-1 4 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 14 E/-1 2 E/-1 2 E/-1 2 F#/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 14 C 14 A/-1 2 A/-1 2 A/-1 2 B/-1 2 A/-1 2 A/-1 2 A/-1 2 A/-1 14 D 14 E/-1 2 E/-1 2 E/-1 2 C 2 E/-1 2 E/-1 2 E/-1 2 B/-1 14 E 14 E/-1 2 E/-1 2 E/-1 2 D 2 E/-1 2 E/-1 2 E/-1 2 C 14 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 14 E/-1 2 E/-1 2 E/-1 2 D 2 E/-1 2 E/-1 2 E/-1 2 C 14 E/-1 4 E/-1 10 F/-1 4 F/-1 10 R 16 E/-1 6 B/-1 6 E 6 G 6 D 6 A 6 D/1 6 A 6 E/1 2 F#/1 2 E/1 2 D/1 6 A 6 G/1 6 C 6 G 6 D/1 6 G 6 D/1 6 G 6 E 6 B 6 A/-1 6 A 6 B 6 A/-1 6 B/-1 6 A 6 B 6 D 6 D# 6 A 6 B 6 B/-1 6 E/-1 6 B/-1 6 E 6 G 6 D 6 A 6 D/1 6 A 6 E/1 2 F#/1 2 E/1 2 D/1 6 A 6 G/1 6 C 6 G 6 D/1 6 G 6 D/1 6 G 6 E 6 B 6 A/-1 6 A 6 B 6 A/-1 6 B/-1 6 A 6 B 6 D 6 D# 6 A 6 B 6 B/-1 6 E/2 6 B/2 6 G/2 6 E/2 6 A/2 6 F#/2 6 D/2 6 D/2 3 D/2 3 D/2 6 A/2 6 Gb/2 6 D/2 6 G/2 6 E/2 6 C/2 6 C/2 3 C/2 3 C/2 6 G/2 6 E/2 6 C/2 6 Gb/2 6 E/2 2 F#/2 2 E/2 2 Eb/2 6 C/2 6 B/1 6 C/2 6 Eb/2 6 C/2 6 Eb/2 6 E/2 6 F#/2 6 G/2 6 E/2 6 B/2 6 G/2 6 E/2 6 A/2 6 F#/2 6 D/2 6 D/2 3 D/2 3 D/2 6 A/2 6 Gb/2 6 D/2 6 G/2 6 E/2 6 C/2 6 C/2 3 C/2 3 C/2 6 G/2 6 E/2 6 C/2 6 Gb/2 6 E/2 2 F#/2 2 E/2 2 Eb/2 6 C/2 6 B/1 6 C/2 6 Eb/2 6 C/2 6 Eb/2 6 E/2 6 F#/2 6 G/2 6 E/2 18 E/2 2 F#/2 2 G/2 18 F#/2 3 G/2 3 A/2 3 G/2 3 F#/2 3 B/2 3 A/2 3 G/2 1 B/2 1 G/2 1 C/2 21 E/2 6 D/2 6 E/2 6 D/2 6 G/2 3 F#/2 3 B/1 6 G/2 3 F#/2 3 B/1 3 D/2 3 B/1 21 G/1 3 A/1 6 B/1 9 A/1 9 D/1 9 E/1 18 D/1 6 G/1 9 A/1 3 G/1 6 Gb/1 6 D/1 6 A/1 6 G/1 6 Gb/1 2 G/1 2 Gb/1 2 C/1 18 A 2 B 2 C/1 18 B 4 C/1 4 D/1 4 C/1 4 D/1 4 E/1 4 F#/1 4 G/1 4 B/1 6 G/1 6 C/3 6 B/2 6 Eb/2 2 B/2 2 Eb/2 2 B/1 6 A/1 6 B/3 6 E/2 6 B/2 6 G/2 6 E/2 6 A/2 6 F#/2 6 D/2 6 D/2 3 D/2 3 D/2 6 A/2 6 Gb/2 6 D/2 6 G/2 6 E/2 6 C/2 6 C/2 3 C/2 3 C/2 6 G/2 6 E/2 6 C/2 6 Gb/2 6 E/2 2 F#/2 2 E/2 2 Eb/2 6 C/2 6 B/1 6 C/2 6 Eb/2 6 C/2 6 Eb/2 6 E/2 6 F#/2 6 G/2 6 E/2 6 B/2 6 G/2 6 E/2 6 A/2 6 F#/2 6 D/2 6 D/2 3 D/2 3 D/2 6 A/2 6 Gb/2 6 D/2 6 G/2 6 E/2 6 C/2 6 C/2 3 C/2 3 C/2 6 G/2 6 E/2 6 C/2 6 Gb/2 6 E/2 2 F#/2 2 E/2 2 Eb/2 6 C/2 6 B/1 6 C/2 6 Eb/2 6 C/2 6 Eb/2 6 E/2 6 F#/2 6 G/2 6 E/-1 6 B/-1 6 E 6 G 6 D 6 A 6 D/1 6 A 6 E/1 2 F#/1 2 E/1 2 D/1 6 A 6 G/1 6 C 6 G 6 D/1 6 G 6 D/1 6 G 6 E 6 B 6 A/-1 6 A 6 B 6 A/-1 6 B/-1 6 A 6 B 6 D 6 D# 6 A 6 B 6 B/-1 6 E/-1 6 B/-1 6 E 6 G 6 D 6 A 6 D/1 6 A 6 E/1 2 F#/1 2 E/1 2 D/1 6 A 6 G/1 6 C 6 G 6 D/1 6 G 6 D/1 6 G 6 E 6 B 6 A/-1 6 A 6 B 6 A/-1 6 B/-1 6 A 6 B 6 D 6 D# 6 A 6 B 6 B/-1 6 E/-1 6 REP 1;15 F#/-1 6 F#/-1 6 G/-1 6 F#/-1 6 F#/-1 6 F#/-1 6 G/-1 6 C# 3 C# 3 F#/-1 6 F#/-1 6 G/-1 6 F#/-1 6 F#/-1 6 F#/-1 6 G/-1 6 C# 6 REP 17;5 G/-1 32 F#/-1 16 E/-1 16 A/2 1 E/2 1 C/2 1 E/2 1 A/2 1 E/2 1 C/2 1 E/2 1 A/2 1 E/2 1 C/2 1 E/2 1 G/2 1 E/2 1 C/2 1 E/2 1 A/2 1 E/2 1 C/2 1 E/2 1 A/2 1 E/2 1 C/2 1 E/2 1 A/2 1 E/2 1 C/2 1 E/2 1 G/2 1 E/2 1 C/2 1 E/2 1 B/2 1 B/2 1 B/2 1 B/2 1 A/2 1 A/2 1 A/2 1 A/2 1 G/2 1 G/2 1 G/2 1 G/2 1 F#/2 1 F#/2 1 F#/2 1 F#/2 1 A/2 1 A/2 1 A/2 1 A/2 1 G/2 1 G/2 1 G/2 1 G/2 1 F#/2 1 F#/2 1 F#/2 1 F#/2 1 D/2 4 F/2 3 E/2 2 F/2 3 D/2 2 E/2 2 REP 1;6 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 A#/-1 2 A/-1 2 G/-1 2 A/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 G/-1 2 A/-1 2 D/2 2 C/2 2 B/1 2 A/1 2 C/2 2 B/1 2 A/1 2 G/1 2 Gb/1 2 G/1 2 B/1 6 B/1 2 B/1 2 B/1 2 D/2 1 C/2 1 B/1 1 B/1 1 D/2 1 C/2 1 B/1 1 B/1 1 E/2 1 D/2 1 C/2 1 C/2 1 E/2 1 D/2 1 C/2 1 C/2 1 F/2 1 E/2 1 D/2 1 D/2 1 F/2 1 E/2 1 D/2 1 D/2 1 F/2 1 E/2 1 E/2 1 D/2 1 F/2 1 E/2 1 E/2 1 A/2 1 G/2 1 F#/2 1 F#/2 1 B/2 1 G/2 1 F#/2 1 F#/2 1 A/2 1 G/2 1 F#/2 1 F#/2 1 B/2 1 G/2 1 F#/2 1 F#/2 1 A/2 1 G/2 1 F#/2 1 F#/2 1 B/2 1 G/2 1 F#/2 1 F#/2 1 A/2 1 G/2 1 F#/2 1 F#/2 1 B/2 1 G/2 1 F#/2 1 F#/2 1 E/2 3 F/2 1 E/2 3 F/2 1 E/2 1 F/2 1 E/2 1 F/2 1 G/2 1 E/2 1 D/2 1 E/2 1 G/2 1 E/2 1 D/2 1 E/2 1 E/2 3 F/2 1 E/2 3 F/2 1 E/2 1 F/2 1 E/2 1 F/2 1 F/2 1 G/2 1 F/2 1 G/2 1 F/2 1 G/2 1 F/2 1 G/2 1 G/2 1 A/2 1 G/2 1 A/2 1 F#/2 1 G#/2 1 F#/2 1 E/3 4 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 B/-1 2 B/-1 2 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 F/-1 2 E/-1 2 E/-1 2 B/-1 4 REP 31;1 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 1 E/-1 1 E/-1 2 F#/-1 2 G/-1 2 A/-1 2 B/-1 2 C 2 D 2 E 2 F# 2 G 2 C 8 C 1 C 1 C 2 B/-1 2 C 2 D 2 C 2 B/-1 2 G/-1 2 F#/-1 2 REP 30;3 E/-1 16 C 1 C 1 C 2 B/-1 2 C 2 D 2 C 2 B/-1 2 G/-1 2 F#/-1 2 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 C# 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 B/-1 2 B/-1 2 E/-1 2 E#/-1 2 B/-1 2 E/-1 2 E#/-1 2 C 2 E/-1 2 E#/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 REP 32;1 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 A#/-1 2 A/-1 2 G/-1 2 A/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 G/-1 2 A/-1 2 REP 30;3 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 A/-1 2 B/-1 2 F#/-1 2 C 2 B/-1 2 A/-1 2 B/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 F#/-1 2 A/-1 2 B/-1 2 F#/-1 2 A/-1 2 B/-1 2 REP 30;1 B/-1 2 REP 1;7 E 2 E/-1 2 E/-1 2 E/-1 2 D 4 E 4 E 2 F# 2 B 2 F# 2 F# 1 G 7 C 2 C 2 C 2 C 2 C 4 B/-1 4 B/-1 2 B/-1 2 B/-1 2 B/-1 2 Eb 4 B/-1 4 REP 24;2 E 2 E/-1 2 E/-1 2 E/-1 2 D 4 E 4 E 2 F# 2 B 2 F# 2 F# 1 G 7 C 2 C 2 C 2 C 2 C 4 B/-1 4 G 2 F# 2 E 4 C 2 B/-1 2 A/-1 4 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 14 E/-1 2 E/-1 2 E/-1 2 F#/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 14 C 14 A/-1 2 A/-1 2 A/-1 2 B/-1 2 A/-1 2 A/-1 2 A/-1 2 A/-1 14 D 14 E/-1 2 E/-1 2 E/-1 2 C 2 E/-1 2 E/-1 2 E/-1 2 B/-1 14 E 14 E/-1 2 E/-1 2 E/-1 2 D 2 E/-1 2 E/-1 2 E/-1 2 C 14 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 14 E/-1 2 E/-1 2 E/-1 2 D 2 E/-1 2 E/-1 2 E/-1 2 C 14 E/-1 4 E/-1 10 F/-1 4 F/-1 10 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 A#/-1 2 A/-1 2 G/-1 2 A/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 E/-1 2 G/-1 2 A/-1 2 E/-1 2 G/-1 2 A/-1 2 REP 30;3 R 8 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 2 G/-1 2 F#/-1 2 E/-1 8"));

        try (ServerSocket listener = new ServerSocket(40000)) {
            System.out.println("The music server is running...");
            while (true) {
                executorService.submit(new MusicBoxHandler(listener.accept()));
            }
        } catch (IOException ignored) {
        }
    }

}
